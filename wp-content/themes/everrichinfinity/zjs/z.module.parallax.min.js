zjs.require("ui, transition",function(){var l=!1,p=!1;zjs.extendCore({moduleParallaxOption:{property:"margin",horizontal:!1,sectionclass:"zparallax-section",elementclass:"zparallax-element",keyframes:!1,indicator:!1,indicatorTemplate:'<a class="indicator">.</a>',autoscaleusecss:!1,scrolltime:800,transition:2,timewaittofocus:200,debug:!1}});var B=function(e,c){var a=zjs(e),d=a.getData("zmoduleparallaxoption");if(d)a.setData("zmoduleparallaxoption",zjs.extend(d,c));else{var d=zjs.clone(zjs.moduleParallaxOption),
b=a.getData("inlineoption","");""==b&&(b=a.getAttr("data-option",""));zjs.isString(b)&&""!=b.trim()&&(d=zjs.extend(d,b.jsonDecode()),a.setData("inlineoption",b));a.removeAttr("data-option");"undefined"!=typeof c&&(d=zjs.extend(d,c));a.setData("zmoduleparallaxoption",d);a.addClass("zparallax");a.addClass(d.horizontal?"zparallax-horizontal":"zparallax-vertical");d.autoscaleusecss&&a.addClass("zparallax-autoscale");var g=!1;d.indicator&&(a.append('<div class="zparallax-indicator-wrapper"><div class="zparallax-indicator-container"></div></div>'),
g=a.find(".zparallax-indicator-container"));var f=[];zSectionEls=a.find("."+d.sectionclass);zSectionEls.each(function(a,c){var b=zjs(a);d.autoscaleusecss&&b.top(100*c+"%");b.setData("zmoduleparallaxautoscale",b.getAttr("data-autoscale"));b.removeAttr("data-autoscale");var k=b.getAttr("data-name","");""==k&&(k="section"+(c+1),b.setAttr("data-name",k));f.push(k);d.indicator&&(b=d.indicatorTemplate,zjs.isFunction(b)&&(b=b(c)),b=b.format({index:c}),zjs(b).addClass("zparallax-indicator").setAttr("data-name",
k).appendTo(g).click(function(a,d){var b=zjs(d).getAttr("data-name","");h(e,b)}))});a.setData("zmoduleparallaxlistsectionname",f);var w=a.find(".zparallax-navigation[data-name]").click(function(){var a=this.getAttr("data-name");h(e,a)});zElementEls=a.find("."+d.elementclass);var x=0,y=0,k=0,q="",z="",r="";zElementEls.each(function(a){a=zjs(a);var b=0,c=0;"margin"==d.property&&(b=a.getStyle("margin-top",0),c=a.getStyle("margin-left",0));a.setData("originalPropertyTop",b).setData("originalPropertyLeft",
c);b=a.getAttr("data-ratio-vertical",0).toFloat();c=a.getAttr("data-ratio-horizontal",0).toFloat();a.setData("ratioVertical",b).setData("ratioHorizontal",c).removeAttr("data-ratio-vertical").removeAttr("data-ratio-horizontal");b=a.getAttr("data-keyframes","");c=!1;zjs.isString(b)&&""!=b.trim()&&(c=b.jsonDecode());a.removeAttr("data-keyframes");zjs.isObject(c)&&"setKeyframes"in a&&a.setKeyframes("zmoduleparallaxautokeyframe",c);b=a.getAttr("data-keyframes-name","");""!=b&&zjs.isObject(d.keyframes)&&
b in d.keyframes&&a.setKeyframes("zmoduleparallaxautokeyframe",d.keyframes[b])});var n=!1,v=function(){!p&&l&&l.stop();p=!1;n||(k=d.horizontal?a.scrollLeft():a.scrollTop());if(!n&&(n=a.getData("zmodulescrollbaroption"))||n)k=a.scrollPosition();a.setData("zmoduleparallaxcurrentscroll",k);zElementEls.each(function(a){a=zjs(a);var b=a.getData("originalPropertyTop").toFloat(),c=a.getData("originalPropertyLeft").toFloat(),e=a.getData("ratioVertical"),g=a.getData("ratioHorizontal"),f=a.findUp("."+d.sectionclass),
h=f.count()?parseFloat(f.getAttr("data-gap-start-at",0),10):0,l=0;f.count()&&(l=d.horizontal?f.left():f.top());var m=(k-l-h)*e,h=(k-l-h)*g,b=b-m,c=c-h;"margin"==d.property&&(e&&a.setStyle("margin-top",b),g&&a.setStyle("margin-left",c));a.isExistsKeyframes("zmoduleparallaxautokeyframe")&&(e=f.count()?parseFloat(f.getAttr("data-keyframe-start-at",0),10):0,a.setStyleByKeyframes("zmoduleparallaxautokeyframe",k-e));a.trigger("parallax.scroll",{currentScroll:k,gapVertical:m,gapHorizontal:h})});var b=t(e);
q=a.getData("zmoduleparallaxcurrentsection","");b!=q&&(d.indicator&&(g.find(".zparallax-indicator.active").removeClass("active"),g.find('.zparallax-indicator[data-name="'+b+'"]').addClass("active")),w.removeClass("active"),w.filter('[data-name="'+b+'"]').addClass("active"),a.setData("zmoduleparallaxcurrentsection",b),a.trigger("parallax.changesection",{currentSection:b,prevSection:q}));z=a.getData("zmoduleparallaxfocussection");b!=z&&.9<u(e,b)&&function(){a.getData("zmoduleparallaxcurrentsection")==
b&&a.getData("zmoduleparallaxfocussection")!=b&&(a.setData("zmoduleparallaxfocussection",b),a.trigger("parallax.changefocussection",{focusSection:b}))}.delay(d.timewaittofocus);var c=A(e);r=a.getData("zmoduleparallaxlastfullscreensection","");var m=a.find("."+d.sectionclass+'[data-name="'+c+'"]').item(0);c!=r&&(a.setData("zmoduleparallaxlastfullscreensection",c),a.trigger("parallax.risingsection",{prevSection:f[f.indexOf(c)-1],nextSection:c,percent:1}),a.trigger("parallax.changefullscreensection",
{lastFullScreenSection:c,prevFullScreenSection:r}));var h=f.indexOf(c);h<f.length-1&&a.trigger("parallax.risingsection",{prevSection:c,nextSection:f[h+1],percent:(k-m.top())/m.height()})},b=function(){x=zjs(window).width();y=zjs(window).height();var b=0;zSectionEls.each(function(a){a=zjs(a);var c=a.getData("zmoduleparallaxautoscale");d.autoscaleusecss||"0"==c||0==c||"false"==c||a.width(x).height(y);b+=a.width()});d.horizontal&&(a.width(b),a.getData("zmodulescrollbaroption")&&a.refreshScroll());v()};
b();a.on("scrollbar.scroll",v);zjs(window).on("scroll",v);zjs(window).on("resize",b);n&&a.refreshScroll();""!=document.location.hash&&function(){h(e,document.location.hash.replace("#",""))}.delay(1E3)}},h=function(e,c){c=c||"";var a=zjs(e),d=a.getData("zmoduleparallaxoption");if(!d)return!1;var b=a.find("."+d.sectionclass+'[data-name="'+c+'"]').item(0);if(1>b.count())return!1;b=b.top();if(a.getData("zmodulescrollbaroption"))return a.scrollTo(b),!0;if(0<d.scrolltime)return l?l.stop():l=zjs.timer({onProcess:function(a){p=
!0;window.scrollTo(d.horizontal?a:0,d.horizontal?0:a)},onFinish:function(){}}),l.set({from:d.horizontal?zjs(window).scrollLeft():zjs(window).scrollTop(),to:b,time:d.scrolltime,transition:d.transition}).run(),!0;window.scrollTo(d.horizontal?b:0,d.horizontal?0:b)},u=function(e,c){c=c||"";var a=zjs(e),d=a.getData("zmoduleparallaxoption");if(!d)return 0;var b=a.find("."+d.sectionclass+'[data-name="'+c+'"]').item(0);if(1>b.count())return 0;var d=b.top(),b=b.height(),a=a.getData("zmoduleparallaxcurrentscroll"),
g=zjs(window).height();if(0>=g)return 0;d=a>=d?(b-a+d)/g:(a+g-d)/g;0>d&&(d=0);return d},t=function(e){var c=zjs(e).getData("zmoduleparallaxlistsectionname",!1);if(!c||!zjs.isArray(c))return"";for(var a="",d=0,b=0;b<c.length;b++){var g=u(e,c[b]);g>d&&(a=c[b],d=g)}return a},A=function(e){e=zjs(e);var c=e.getData("zmoduleparallaxlistsectionname",!1);if(!c||!zjs.isArray(c))return"";for(var a=e.getData("zmoduleparallaxoption"),d=e.getData("zmoduleparallaxcurrentscroll",0),b="",g=!1,f=0;f<c.length-1;f++)g=
e.find("."+a.sectionclass+'[data-name="'+c[f]+'"]').item(0),1>g.count()||d>=g.top()&&(b=c[f]);return b};zjs.extendMethod({makeParallax:function(e){return this.each(function(c){B(c,e)})},parallaxScrollToSection:function(e){return this.each(function(c){h(c,e)})},parallaxScrollToNextSection:function(){return this.each(function(e){var c=zjs(e).getData("zmoduleparallaxlistsectionname",!1);if(c||zjs.isArray(c)){var a=t(e);a&&(c=c[c.indexOf(a)+1])&&h(e,c)}})},parallaxGetRatioVisible:function(e){return u(this.item(0,
!0),e)},parallaxGetCurrentSection:function(){return t(this.item(0,!0))},parallaxGetLastFullScreenSection:function(){return A(this.item(0,!0))}});zjs.hook({after_setInnerHTML:function(e){zjs(e).find(".zparallax").makeParallax()},after_insertDOM:function(e){zjs(e).hasClass("zparallax")&&zjs(e).makeParallax();zjs(e).find(".zparallax").makeParallax()}});zjs.onready(function(){zjs(".zparallax").makeParallax()});"required"in zjs&&zjs.required("parallax")});