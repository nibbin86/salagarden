zjs.require("ui",function(){zjs.extendCore({moduleUiHovercardOption:{timeBeforeShow:0,timeBeforeHide:200,attribute:"title",horizontal:"left",vertical:"top",autoFixPosition:!0,autoFixArrowPosition:!0,hideWhenHoverCard:!1,customCssClass:"",left:"auto",right:"auto",top:"auto",bottom:"auto",appendToBody:!1,ajaxContent:!1}});var v=function(a,b){var c=zjs(a),d=c.getData("zmoduleuihovercardoption");if(d)c.setData("zmoduleuihovercardoption",zjs.extend(d,b));else{var d=zjs.clone(zjs.moduleUiHovercardOption),
e=c.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(d=zjs.extend(d,e.jsonDecode()));c.removeAttr("data-option");"undefined"!=typeof b&&(d=zjs.extend(d,b));c.setData("zmoduleuihovercardoption",d);c.addClass("zui-hovercard");e=zjs('<div class="zui-hovercard-panel-wrap zui-uiuninithide"><div class="zui-hovercard-panel-arrow"></div><div class="zui-hovercard-panel"><div class="zui-hovercard-panel-inner"></div></div></div>');if(d.appendToBody){var f=zjs(document.body).getStyle("position");""!=
f&&"static"!=f||zjs(document.body).setStyle("position","relative");e.appendTo(top.document.body).setStyle("z-index",10)}else e.insertAfter(c);""!=d.customCssClass&&e.addClass(d.customCssClass);c.setData("zmoduleuihovercardwrapel",e);var k=!1;c.longHover(function(){window.clearTimeout(k);k=!1;r(a)},function(b){k=window.setTimeout(function(){m(a,d.hideWhenHoverCard?!1:b)},d.timeBeforeHide)},d.timeBeforeShow);if(!d.hideWhenHoverCard)e.on("mouseover",function(a){window.clearTimeout(k);k=!1}).on("mouseout",
function(b){k=window.setTimeout(function(){m(a,b)},d.timeBeforeHide)});var f=e.find(".zui-hovercard-panel-inner"),p=c.getAttr(d.attribute,"");p&&("title"==d.attribute&&(e.addClass("zui-tooltip"),c.removeAttr("title")),f.html(p));f.setData("zmoduleuihovercardel",c);e.addClass("zui-uihide").removeClass("zui-uiuninithide")}},r=function(a){var b=zjs(a),c=b.getData("zmoduleuihovercardoption"),d=b.getData("zmoduleuihovercardwrapel");if(d){try{var e=b.getStyle("position","");""!=e&&"static"!=e||b.is("tr")||
b.addClass("zui-hovercard-fix")}catch(f){}if(c.ajaxContent&&!b.getData("zmoduleuihovercardajaxloaded")){var k=d.find(".zui-hovercard-panel-inner");zjs.ajax({url:c.ajaxContent,type:"raw",cache:!1,onComplete:function(c){b.setData("zmoduleuihovercardajaxloaded",!0);k.html(c);m(a);r(a)}})}else d.removeClass("zui-uihide"),u(a)}},m=function(a,b){var c=zjs(a),d=c.getData("zmoduleuihovercardwrapel");if(d){if(b){var e=d.item(0,!0);try{for(var f=b.toTarget();f;){if(f==e)return;if(f==document)break;f=f.parentNode}}catch(k){}}c.removeClass("zui-hovercard-fix");
d.addClass("zui-uihide").removeClass("zui-left").removeClass("zui-right").removeClass("zui-top").removeClass("zui-bottom").top("auto").bottom("auto").left("auto").top("auto")}},u=function(a){var b=zjs(a),c=b.getData("zmoduleuihovercardwrapel");if(c){var d=c.find(".zui-hovercard-panel-arrow");c.find(".zui-hovercard-panel-inner");var e=b.left(),f=b.right(),k=b.top(),p=b.bottom(),l=b.width(),m=b.height(),n=c.width(),s=c.height(),g=b.getData("zmoduleuihovercardoption"),h=g.horizontal,q=g.vertical;if(g.appendToBody){for(var e=
b.getAbsoluteLeft(),f=b.getAbsoluteRight(),k=b.getAbsoluteTop(),p=b.getAbsoluteBottom(),b="",t=!1;a&&a!=document.body;){try{if(b=zjs(a).getStyle("position"),"fixed"==b){t=!0;break}}catch(r){}a=a.parentNode}!0==g.autoFixPosition&&(a=zjs(window),"top"==q&&zjs(document.body).height()-p-m-s<(t?0:document.body.scrollTop)&&(q="bottom"),"bottom"==q&&(b=a.height(),k+m+s>(t?0:document.body.scrollTop)+b&&(q="top")),"right"==h&&zjs(document.body).width()-f-l-n<document.body.scrollLeft&&(h="left"),"left"==h&&
(s=a.width(),e+l+n>document.body.scrollLeft+s&&(h="right")))}else!0==g.autoFixPosition&&("center"==h&&n/2>l/2+e&&(h="left"),"center"==h&&n/2>l/2+f&&(h="right"),"left"==h&&n>l+f&&(h="right"),"right"==h&&n>l+e&&(h="left"));"center"==h?(c.addClass("zui-left"),c.left(e-n/2+l/2),d.left(n/2)):"left"==h?(c.addClass("zui-left"),c.left("auto"==g.left?e:parseInt(g.left)),g.autoFixArrowPosition&&d.left("auto"==g.left?l/2:l/2+e-g.left)):"right"==h&&(c.addClass("zui-right"),c.right("auto"==g.right?f:parseInt(g.right)),
g.autoFixArrowPosition&&d.right("auto"==g.right?l/2:l/2+f-g.right));"top"==q?(c.addClass("zui-top"),c.bottom("auto"==g.bottom?p+m:g.bottom)):"bottom"==q&&(c.addClass("zui-bottom"),c.top("auto"==g.top?k+m:g.top));t?c.addClass("zui-fixed"):c.removeClass("zui-fixed")}};zjs.extendMethod({makeHovercard:function(a){return this.each(function(b){v(b,a)})},hovercardShow:function(a){return this.each(function(a){r(a)})},hovercardHide:function(a){return this.each(function(a){m(a,!1)})},hovercardPanel:function(){var a=
[];this.each(function(b){(b=zjs(b).getData("zmoduleuihovercardwrapel"))&&a.push(b.item(0,!0))});return zjs(a)}});zjs.hook({after_setInnerHTML:function(a){a=zjs(a);a.find(".zhovercard").makeHovercard();a.find(".zhovercardcenter").makeHovercard({horizontal:"center"});a.find(".zhovercardleft").makeHovercard({horizontal:"left"});a.find(".zhovercardright").makeHovercard({horizontal:"right"});a.hasClass("zui-hovercard-panel-inner")&&u(a.getData("zmoduleuihovercardel"))},after_insertDOM:function(a){zjs(a).hasClass("zhovercard")&&
zjs(a).makeHovercard();zjs(a).hasClass("zhovercardcenter")&&zjs(a).makeHovercard({horizontal:"center"});zjs(a).hasClass("zhovercardleft")&&zjs(a).makeHovercard({horizontal:"left"});zjs(a).hasClass("zhovercardright")&&zjs(a).makeHovercard({horizontal:"right"});zjs(a).find(".zhovercard").makeHovercard();zjs(a).find(".zhovercardcenter").makeHovercard({horizontal:"center"});zjs(a).find(".zhovercardleft").makeHovercard({horizontal:"left"});zjs(a).find(".zhovercardright").makeHovercard({horizontal:"right"})}});
zjs.onready(function(){zjs(".zhovercard").makeHovercard();zjs(".zhovercardcenter").makeHovercard({horizontal:"center"});zjs(".zhovercardleft").makeHovercard({horizontal:"left"});zjs(".zhovercardright").makeHovercard({horizontal:"right"})});"required"in zjs&&zjs.required("ui.hovercard")});